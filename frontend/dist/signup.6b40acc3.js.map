{"version":3,"sources":["../constants/paths.ts","../scripts/App.ts","../scripts/auth.ts","../scripts/pages/signup.ts"],"names":[],"mappings":";AAOa,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,YAAA,QAAA,WAAA,QAAA,UAAA,QAAA,gBAAA,EAPA,QAAA,WAAa,SAAC,GACzB,OAAO,SAAS,SAAW,GAGhB,QAAA,UAAY,aAEZ,QAAA,WAAa,aACb,QAAA,YAAc;;ACyCd,aAAA,IAAA,EAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,UAAA,QAAA,gBAAA,QAAA,qBAAA,EAhDb,IAAA,EAAA,QAAA,sBACA,EAAA,QAAA,UAEa,QAAA,gBAAkB,SAAC,GACxB,IAAA,EAAa,SAAS,eAAe,aAC3C,EAAW,UAAY,GACvB,EAAS,IAAI,SAAC,GACN,IAAA,EAAW,SAAS,cAAc,KACxC,EAAS,GAAK,WACd,EAAS,YAAY,SAAS,eAAe,EAAQ,QACrD,EAAS,iBAAiB,QAAS,WAAM,OAAA,EAAA,WAAW,EAAQ,YAC5D,EAAW,YAAY,MAId,QAAA,gBAAkB,WAAA,OAAA,OAAA,OAAA,OAAA,EAAA,WAiClB,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EA7BE,OAHP,EAAa,SAAS,eAAe,eAChC,UAAY,GAEV,CAAA,EAAM,EAAA,WA6BR,KAAA,EAAA,OA7BL,EAAO,EAAA,OACb,QAAQ,IAAI,iBAAkB,GACzB,IAYG,EAAQ,SAAS,cAAc,MAC/B,YAAY,SAAS,eAAe,WAAa,EAAK,QAC5D,EAAW,YAAY,IAEjB,EAAiB,SAAS,cAAc,WAC/B,YAAY,SAAS,eAAe,YACnD,EAAe,iBAAiB,QAAS,WACvC,EAAA,YAAY,KAAK,WACf,OAAO,SAAS,aAGpB,EAAW,YAAY,MAtBjB,EAAgB,SAAS,cAAc,QAC/B,YAAY,SAAS,eAAe,uBAClD,EAAW,YAAY,IAEjB,EAAe,SAAS,cAAc,WAC/B,YAAY,SAAS,eAAe,UACjD,EAAa,iBAAiB,QAAS,WACrC,EAAA,WAAW,EAAA,cAEb,EAAW,YAAY,IAiBd,CAAA,SAAA,QAAA,WAAwC,QAApB,EAAA,oBAAoB,IAAA,OAAA,EAAA,EAAE,SAAS,UAC5D,yBACA;;ACaS,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,MAAA,aAAA,EAAA,EAAA,IAAA,EAAA,SAAA,GAAA,EAAA,MAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,EAAA,MAAA,KAAA,aAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,MAAA,EAAA,KAAA,WAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,KAAA,GAAA,IAAA,IAAA,OAAA,EAAA,CAAA,KAAA,EAAA,GAAA,MAAA,EAAA,GAAA,OAAA,EAAA,IAAA,mBAAA,SAAA,EAAA,OAAA,UAAA,WAAA,OAAA,OAAA,EAAA,SAAA,EAAA,GAAA,OAAA,SAAA,GAAA,OAAA,SAAA,GAAA,GAAA,EAAA,MAAA,IAAA,UAAA,mCAAA,KAAA,GAAA,IAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA,OAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,SAAA,EAAA,KAAA,GAAA,GAAA,EAAA,SAAA,EAAA,EAAA,KAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,OAAA,EAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,GAAA,EAAA,QAAA,EAAA,IAAA,KAAA,EAAA,KAAA,EAAA,EAAA,EAAA,MAAA,KAAA,EAAA,OAAA,EAAA,QAAA,CAAA,MAAA,EAAA,GAAA,MAAA,GAAA,KAAA,EAAA,EAAA,QAAA,EAAA,EAAA,GAAA,EAAA,CAAA,GAAA,SAAA,KAAA,EAAA,EAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,QAAA,KAAA,GAAA,EAAA,EAAA,MAAA,OAAA,GAAA,EAAA,EAAA,OAAA,MAAA,IAAA,EAAA,IAAA,IAAA,EAAA,IAAA,CAAA,EAAA,EAAA,SAAA,GAAA,IAAA,EAAA,MAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,CAAA,EAAA,MAAA,EAAA,GAAA,MAAA,GAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,EAAA,MAAA,GAAA,GAAA,EAAA,MAAA,EAAA,GAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,KAAA,GAAA,MAAA,EAAA,IAAA,EAAA,IAAA,MAAA,EAAA,KAAA,MAAA,SAAA,EAAA,EAAA,KAAA,EAAA,GAAA,MAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,EAAA,EAAA,GAAA,MAAA,EAAA,GAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,QAAA,EAAA,MAAA,GAAA,CAAA,CAAA,EAAA,OAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,qBAAA,QAAA,iBAAA,QAAA,cAAA,QAAA,WAAA,QAAA,QAAA,QAAA,SAAA,QAAA,UAAA,QAAA,aAAA,EA/Db,IAAA,EAAA,QAAA,SAEa,QAAA,QAAU,SAAO,GAAqB,OAAA,OAAA,OAAA,OAAA,EAAA,WA6DtC,IAAA,EAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EAzDM,OAHjB,QAAQ,IAAI,EAAA,WACN,EAAM,EAAA,UAAY,aACxB,QAAQ,IAAI,KAAK,UAAU,IACV,CAAA,EAAM,MAAM,EAAK,QAAA,iBAAiB,KAyDxC,KAAA,EAvDM,MAAA,CAAA,EAFA,EAAA,OAEe,QAuDrB,KAAA,EAAA,OAvDL,EAAW,EAAA,OACjB,QAAQ,IAAI,EAAO,cACnB,aAAa,QAAQ,WAAY,EAAO,cAqD7B,CAAA,SAlDA,QAAA,UAAY,WAAA,OAAA,OAAA,OAAA,OAAA,EAAA,WAkDZ,OAAA,EAAA,KAAA,SAAA,GAhDX,OADA,aAAa,WAAW,YACxB,CAAA,QAGW,QAAA,SAAW,SAAO,GAAsB,OAAA,OAAA,OAAA,OAAA,EAAA,WA6CxC,IAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EA3CM,OADX,EAAM,EAAA,UAAY,cACP,CAAA,EAAM,MAAM,EAAK,QAAA,iBAAiB,KA2CxC,KAAA,EAAA,OA3CM,EAAA,OACR,OAAO,KAAK,SAAC,GAAM,OAAA,QAAQ,IAAI,KA0C7B,CAAA,SAtCA,QAAA,QAAU,WAAA,OAAA,OAAA,OAAA,EAAU,QAAO,WAsC3B,IAAA,EAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OAAA,EAAA,OAAA,KAAA,EApCM,OADX,EAAM,EAAA,UAAY,YACP,CAAA,EAAM,MAAM,EAAK,CAAE,QAAS,QAAA,mBAoClC,KAAA,EAnCK,MAAA,CAAA,EADC,EAAA,OACc,QAmCpB,KAAA,EAlCX,MAAA,CAAA,GADM,EAAU,EAAA,QACF,OAAS,EAAO,IAAM,EAAS,YAGlC,QAAA,WAAa,WAAA,OAAA,OAAA,OAAA,OAAA,EAAA,WA+Bb,IAAA,EAAA,OAAA,EAAA,KAAA,SAAA,GAAA,OA9BL,EAAM,EAAA,UAAY,UAExB,MAAM,EAAK,CACT,QAAS,QAAA,kBACR,KAAK,SAAC,GACP,QAAQ,IAAI,GACZ,EAAK,OAAO,KAAK,SAAC,GAChB,QAAQ,IAAI,OAuBL,CAAA,QAlBA,QAAA,cAAgB,WACrB,IAAA,EAAQ,aAAa,QAAQ,YAE5B,OADP,QAAQ,IAAI,aAAc,GACnB,CACL,cAAe,UAAU,IAIhB,QAAA,iBAAmB,SAAC,GACxB,MAAA,CACL,OAAQ,OACR,QAAS,CACS,eAAA,oBAElB,KAAM,KAAK,UAAU,KAIZ,QAAA,qBAAuB,SAAC,GAE5B,MAAA,CACL,OAAQ,OACR,QAAS,CACP,cAAe,UAJL,aAAa,QAAQ,YAKf,eAAA,oBAElB,KAAM,KAAK,UAAU;;ACxCzB,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IA/BA,IAAA,EAAA,QAAA,WAEM,EAAS,SAAS,eAAe,eACjC,EAAY,SAAS,eAAe,kBACpC,EAAmB,SAAS,eAChC,oBAGI,EAAgB,SAAS,eAC7B,iBAGI,EAAW,SAAC,GAKR,IAAA,EAAqC,EAAK,MAAnC,EAA8B,EAAK,SAAzB,EAAoB,EAAK,gBAE9C,QAAC,MAGA,MAGA,GAAmB,GAAY,KAMtC,EAAc,iBAAiB,QAAS,WAChC,IAAA,EAAQ,EAAO,MACf,EAAW,EAAU,MACrB,EAAkB,EAAiB,MACrC,EAAS,CAAE,MAAK,EAAE,SAAQ,EAAE,gBAAe,KAC7C,EAAA,SAAS,CAAE,MAAK,EAAE,UAAW","file":"signup.6b40acc3.js","sourceRoot":"..\\src\\pages","sourcesContent":["export const navigateTo = (pathname: string) => {\r\n  window.location.pathname = pathname;\r\n};\r\n\r\nexport const HOME_PATH = \"index.html\";\r\n\r\nexport const LOGIN_PATH = \"login.html\";\r\nexport const SIGNUP_PATH = \"signup.html\";\r\n","import { LOGIN_PATH, navigateTo } from \"../constants/paths\";\r\nimport { doSignOut, getUser } from \"./auth\";\r\n\r\nexport const renderNavigator = (navItems: NavItem[]) => {\r\n  const $navigator = document.getElementById(\"navigator\") as HTMLDivElement;\r\n  $navigator.innerHTML = \"\";\r\n  navItems.map((navItem) => {\r\n    const $navItem = document.createElement(\"a\");\r\n    $navItem.id = \"nav-item\";\r\n    $navItem.appendChild(document.createTextNode(navItem.title));\r\n    $navItem.addEventListener(\"click\", () => navigateTo(navItem.pathname));\r\n    $navigator.appendChild($navItem);\r\n  });\r\n};\r\n\r\nexport const renderUserState = async () => {\r\n  const $userState = document.getElementById(\"user-state\") as HTMLDivElement;\r\n  $userState.innerHTML = \"\";\r\n\r\n  const user = await getUser();\r\n  console.log(`got user state`, user);\r\n  if (!user) {\r\n    const $loginRequire = document.createElement(\"div\");\r\n    $loginRequire.appendChild(document.createTextNode(\"please login first\"));\r\n    $userState.appendChild($loginRequire);\r\n\r\n    const $loginButton = document.createElement(\"button\");\r\n    $loginButton.appendChild(document.createTextNode(\"LOGIN\"));\r\n    $loginButton.addEventListener(\"click\", () => {\r\n      navigateTo(LOGIN_PATH);\r\n    });\r\n    $userState.appendChild($loginButton);\r\n  } else {\r\n    const $user = document.createElement(\"p\");\r\n    $user.appendChild(document.createTextNode(`email : ` + user.email));\r\n    $userState.appendChild($user);\r\n\r\n    const $signoutButton = document.createElement(\"button\");\r\n    $signoutButton.appendChild(document.createTextNode(\"SIGNOUT\"));\r\n    $signoutButton.addEventListener(\"click\", () => {\r\n      doSignOut().then(() => {\r\n        window.location.reload();\r\n      });\r\n    });\r\n    $userState.appendChild($signoutButton);\r\n  }\r\n};\r\n\r\nexport const serverUrl: string = process.env.NODE_ENV?.includes(\"LOCAL\")\r\n  ? \"http://localhost:5001/\"\r\n  : process.env.SERVER_URL || \"SERVER_URL not found\";\r\n","import { serverUrl } from \"./App\";\r\n\r\nexport const doLogin = async (request: LoginRequest) => {\r\n  console.log(serverUrl);\r\n  const url = serverUrl + \"auth/login\";\r\n  console.log(JSON.stringify(request));\r\n  const response = await fetch(url, createPostOption(request));\r\n\r\n  const result = ((await response.json()) as unknown) as LoginResult;\r\n  console.log(result.access_token);\r\n  localStorage.setItem(\"jwtToken\", result.access_token);\r\n};\r\n\r\nexport const doSignOut = async () => {\r\n  localStorage.removeItem(\"jwtToken\");\r\n  return;\r\n};\r\n\r\nexport const doSignUp = async (request: SignUpRequest) => {\r\n  const url = serverUrl + \"auth/signup\";\r\n  const response = await fetch(url, createPostOption(request));\r\n  response.json().then((v) => console.log(v));\r\n  // const result = await response.json() as unknown as SignupResu\r\n};\r\n\r\nexport const getUser = async (): Promise<User | null> => {\r\n  const url = serverUrl + \"auth/user\";\r\n  const response = await fetch(url, { headers: getAuthHeader() });\r\n  const result = (await response.json()) as User;\r\n  return result.email && result.uid ? result : null;\r\n};\r\n\r\nexport const getProfile = async () => {\r\n  const url = serverUrl + \"profile\";\r\n\r\n  fetch(url, {\r\n    headers: getAuthHeader(),\r\n  }).then((resp) => {\r\n    console.log(resp);\r\n    resp.json().then((data) => {\r\n      console.log(data);\r\n    });\r\n  });\r\n};\r\n\r\nexport const getAuthHeader = () => {\r\n  const token = localStorage.getItem(\"jwtToken\");\r\n  console.log(\"auth token\", token);\r\n  return {\r\n    Authorization: `Bearer ${token}`,\r\n  };\r\n};\r\n\r\nexport const createPostOption = (body: Object): RequestInit => {\r\n  return {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(body),\r\n  };\r\n};\r\n\r\nexport const createAuthPostOption = (body: Object): RequestInit => {\r\n  const token = localStorage.getItem(\"jwtToken\");\r\n  return {\r\n    method: \"POST\",\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(body),\r\n  };\r\n};\r\n","import { doSignUp } from \"../auth\";\r\n\r\nconst $email = document.getElementById(\"email-input\") as HTMLInputElement;\r\nconst $password = document.getElementById(\"password-input\") as HTMLInputElement;\r\nconst $passwordConfirm = document.getElementById(\r\n  \"password-confirm\"\r\n) as HTMLInputElement;\r\n\r\nconst $signupButton = document.getElementById(\r\n  \"signup-button\"\r\n) as HTMLButtonElement;\r\n\r\nconst validate = (props: {\r\n  email: string;\r\n  password: string;\r\n  passwordConfirm: string;\r\n}): Boolean => {\r\n  const { email, password, passwordConfirm } = props;\r\n  //   todo : need to add email validator\r\n  if (!email) {\r\n    return false;\r\n  }\r\n  if (!password) {\r\n    return false;\r\n  }\r\n  if (!passwordConfirm || password != passwordConfirm) {\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\n$signupButton.addEventListener(\"click\", () => {\r\n  const email = $email.value;\r\n  const password = $password.value;\r\n  const passwordConfirm = $passwordConfirm.value;\r\n  if (validate({ email, password, passwordConfirm })) {\r\n    doSignUp({ email, _password: password });\r\n  }\r\n});\r\n"]}